-- 코드를 입력하세요
SELECT      B.YEAR
        ,   TO_NUMBER(B.MONTH) AS MONTH
        ,   A.GENDER
        ,   COUNT(DISTINCT B.USER_ID) AS USERS	// 같은 달 다른날에 동일한 회원은 결과에서 제외시켜야함
FROM USER_INFO A
INNER JOIN
(
    SELECT      TO_CHAR(SALES_DATE, 'YYYY') AS YEAR
            ,   TO_CHAR(SALES_DATE, 'MM') AS MONTH
            ,   USER_ID
    FROM ONLINE_SALE 
)B
 ON A.USER_ID = B.USER_ID
WHERE GENDER IS NOT NULL
GROUP BY B.YEAR, B.MONTH, GENDER
ORDER BY 1,2,3

---------------------------------------------------------
SELECT
    EXTRACT(YEAR FROM SALES_DATE) YEAR,
    EXTRACT(MONTH FROM SALES_DATE) MONTH, 
    GENDER, 
    COUNT(DISTINCT OS.USER_ID) USERS
FROM USER_INFO UI JOIN ONLINE_SALE OS
ON UI.USER_ID=OS.USER_ID
WHERE GENDER IS NOT NULL
GROUP BY
    EXTRACT(YEAR FROM SALES_DATE), 
    EXTRACT(MONTH FROM SALES_DATE), 
    GENDER
ORDER BY YEAR, MONTH, GENDER ASC